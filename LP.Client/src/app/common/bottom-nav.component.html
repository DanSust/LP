<!-- bottom-nav.component.html -->
<nav class="bottom-nav" *ngIf="true">
  <div *ngFor="let item of navItems()"
       class="nav-item"
       [class.active]="!isMenuItem(item) && isActive(item.route)"
       [class.menu-item]="isMenuItem(item)">

    <!-- Обычная иконка -->
    <div class="nav-icon" *ngIf="!isMenuItem(item)" (click)="onItemClick(item, $event)">
      <span class="material-icons">{{ item.icon }}</span>
      <span class="badge"
            *ngIf="item.badge && item.badge > 0"
            [class.badge-pulse]="item.badge > 3">
        {{ item.badge > 9 ? '9+' : item.badge }}
      </span>
    </div>

    <!-- Троеточие с меню - используем mousedown вместо click -->
    <div class="nav-icon menu-wrapper"
         *ngIf="isMenuItem(item)"
         (mousedown)="$event.stopPropagation()">
      <button mat-icon-button
              [matMenuTriggerFor]="moreMenu"
              class="more-btn">
        <span class="material-icons">{{ item.icon }}</span>
      </button>
    </div>
  </div>
</nav>

<mat-menu #moreMenu="matMenu" class="bottom-nav-menu" xPosition="before">
  <button mat-menu-item (click)="onAbout()">
    <mat-icon>info</mat-icon>
    <span>О сайте</span>
  </button>
  <button mat-menu-item (click)="onNews()">
    <mat-icon>feed</mat-icon>
    <span>Новости</span>
  </button>
  <button mat-menu-item (click)="onLogout()">
    <mat-icon>logout</mat-icon>
    <span>Выход</span>
  </button>
</mat-menu>
